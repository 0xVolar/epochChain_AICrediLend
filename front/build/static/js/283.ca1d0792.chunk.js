"use strict";(self.webpackChunkai_credit_lending=self.webpackChunkai_credit_lending||[]).push([[283],{7283:(t,a,n)=>{n.r(a),n.d(a,{StakingService:()=>c,default:()=>g});var i=n(7295),r=n(6283),s=n(4085),e=n(6742);const o=t=>({type:"staking/setStakingLoading",payload:t});class c{constructor(){this.stakingContract=null,this.contractAddress="0xabcdef123456789abcdef123456789abcdef1234"}async initContract(){try{const t=s.A.getSigner();if(!t)throw new Error("\u672a\u8fde\u63a5\u94b1\u5305");const a=["function getStakedAmount(address staker) view returns (uint256)","function getRewards(address staker) view returns (uint256)","function getPenalties(address staker) view returns (uint256)","function stake(uint256 amount) returns (bool)","function unstake(uint256 amount) returns (bool)","function claimRewards() returns (uint256)"];return this.stakingContract=new i.NZ(this.contractAddress,a,t),!0}catch(t){return console.error("\u521d\u59cb\u5316\u8d28\u62bc\u5408\u7ea6\u5931\u8d25:",t),!1}}async getStakingInfo(t){try{if(e.M.dispatch(o(!0)),this.stakingContract||await this.initContract(),!this.stakingContract)throw new Error("\u5408\u7ea6\u672a\u521d\u59cb\u5316");const a=await this.stakingContract.getStakedAmount(t),n=await this.stakingContract.getRewards(t),i=await this.stakingContract.getPenalties(t);return e.M.dispatch({type:"staking/updateStakingInfo",payload:{stakedAmount:r.ck(a),rewards:r.ck(n),penalties:r.ck(i)}}),e.M.dispatch(o(!1)),{stakedAmount:r.ck(a),rewards:r.ck(n),penalties:r.ck(i)}}catch(a){throw console.error("\u83b7\u53d6\u8d28\u62bc\u4fe1\u606f\u5931\u8d25:",a),e.M.dispatch(o(!1)),a}}async stakeTokens(t){try{var a;if(this.stakingContract||await this.initContract(),!this.stakingContract)throw new Error("\u5408\u7ea6\u672a\u521d\u59cb\u5316");const n=await this.stakingContract.stake(r.g5(t));await n.wait();const i=await(null===(a=s.A.getSigner())||void 0===a?void 0:a.getAddress());return i&&await this.getStakingInfo(i),!0}catch(n){throw console.error("\u8d28\u62bc\u4ee3\u5e01\u5931\u8d25:",n),n}}async unstakeTokens(t){try{var a;if(this.stakingContract||await this.initContract(),!this.stakingContract)throw new Error("\u5408\u7ea6\u672a\u521d\u59cb\u5316");const n=await this.stakingContract.unstake(r.g5(t));await n.wait();const i=await(null===(a=s.A.getSigner())||void 0===a?void 0:a.getAddress());return i&&await this.getStakingInfo(i),!0}catch(n){throw console.error("\u53d6\u56de\u8d28\u62bc\u5931\u8d25:",n),n}}async claimRewards(){try{var t;if(this.stakingContract||await this.initContract(),!this.stakingContract)throw new Error("\u5408\u7ea6\u672a\u521d\u59cb\u5316");const a=await this.stakingContract.claimRewards(),n=(await a.wait(),await(null===(t=s.A.getSigner())||void 0===t?void 0:t.getAddress()));n&&await this.getStakingInfo(n);return"0"}catch(a){throw console.error("\u9886\u53d6\u5956\u52b1\u5931\u8d25:",a),a}}async calculatePenalty(t){try{var a;const n=await(null===(a=s.A.getSigner())||void 0===a?void 0:a.getAddress());if(!n)throw new Error("\u672a\u8fde\u63a5\u94b1\u5305");const i=await this.getStakingInfo(n),e=r.g5(i.stakedAmount),o=10n*r.g5(t)/100n,c=o>e?e:o;return r.ck(c)}catch(n){throw console.error("\u8ba1\u7b97\u8d28\u62bc\u60e9\u7f5a\u5931\u8d25:",n),n}}}const g=new c}}]);
//# sourceMappingURL=283.ca1d0792.chunk.js.map